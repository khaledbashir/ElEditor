{"version":3,"file":"overlay.js","sourceRoot":"","sources":["../../src/renderer/overlay.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,MAAM,uBAAuB,CAAC;AAClD,OAAO,EAEL,uBAAuB,GACxB,MAAM,2BAA2B,CAAC;AACnC,OAAO,EAAkB,gBAAgB,EAAE,MAAM,uBAAuB,CAAC;AACzE,OAAO,EAAE,eAAe,EAAE,SAAS,EAAE,MAAM,+BAA+B,CAAC;AAK3E;;;GAGG;AACH,MAAM,OAAgB,OAAQ,SAAQ,SAAS;aACtC,gBAAW,GAAW,EAAE,AAAb,CAAc;IAIhC,YAAsB,GAAkB;QACtC,KAAK,EAAE,CAAC;QADY,QAAG,GAAH,GAAG,CAAe;QAF9B,cAAS,GAA0B,IAAI,CAAC;IAIlD,CAAC;IAED,MAAM,CAAU,KAAK,CAAC,EAAa;QACjC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;YACtB,MAAM,IAAI,eAAe,CACvB,SAAS,CAAC,cAAc,EACxB,4BAA4B,IAAI,CAAC,IAAI,gDAAgD,CACtF,CAAC;QACJ,CAAC;QAED,EAAE,CAAC,OAAO,CAAC,iBAAiB,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,IAAI,EAAE;YACpD,uBAAuB;SACxB,CAAC,CAAC;IACL,CAAC;IAED,KAAK,KAAI,CAAC;IAEV,OAAO,KAAI,CAAC;IAEZ,OAAO;QACL,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;YACnB,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;QAC3B,CAAC;IACH,CAAC;IAID,WAAW,CAAC,QAA+B;QACzC,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;IAC5B,CAAC;;AAGH,MAAM,CAAC,MAAM,iBAAiB,GAAG,gBAAgB,CAAU,SAAS,CAAC,CAAC","sourcesContent":["import { Extension } from '@blocksuite/block-std';\nimport {\n  type GfxController,\n  GfxControllerIdentifier,\n} from '@blocksuite/block-std/gfx';\nimport { type Container, createIdentifier } from '@blocksuite/global/di';\nimport { BlockSuiteError, ErrorCode } from '@blocksuite/global/exceptions';\n\nimport type { RoughCanvas } from '../utils/rough/canvas.js';\nimport type { CanvasRenderer } from './canvas-renderer.js';\n\n/**\n * An overlay is a layer covered on top of elements,\n * can be used for rendering non-CRDT state indicators.\n */\nexport abstract class Overlay extends Extension {\n  static overlayName: string = '';\n\n  protected _renderer: CanvasRenderer | null = null;\n\n  constructor(protected gfx: GfxController) {\n    super();\n  }\n\n  static override setup(di: Container): void {\n    if (!this.overlayName) {\n      throw new BlockSuiteError(\n        ErrorCode.ValueNotExists,\n        `The overlay constructor '${this.name}' should have a static 'overlayName' property.`\n      );\n    }\n\n    di.addImpl(OverlayIdentifier(this.overlayName), this, [\n      GfxControllerIdentifier,\n    ]);\n  }\n\n  clear() {}\n\n  dispose() {}\n\n  refresh() {\n    if (this._renderer) {\n      this._renderer.refresh();\n    }\n  }\n\n  abstract render(ctx: CanvasRenderingContext2D, rc: RoughCanvas): void;\n\n  setRenderer(renderer: CanvasRenderer | null) {\n    this._renderer = renderer;\n  }\n}\n\nexport const OverlayIdentifier = createIdentifier<Overlay>('Overlay');\n"]}