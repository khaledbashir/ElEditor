{"version":3,"file":"frame-panel-header.js","sourceRoot":"","sources":["../../../../src/fragments/frame-panel/header/frame-panel-header.ts"],"names":[],"mappings":"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","sourcesContent":["import type { EditorHost } from '@blocksuite/block-std';\n\nimport {\n  createButtonPopper,\n  DocModeProvider,\n  EdgelessRootService,\n  EditPropsStore,\n  type NavigatorMode,\n} from '@blocksuite/blocks';\nimport { DisposableGroup, WithDisposable } from '@blocksuite/global/utils';\nimport { css, html, LitElement, type PropertyValues } from 'lit';\nimport { property, query, state } from 'lit/decorators.js';\n\nimport { SettingsIcon, SmallFrameNavigatorIcon } from '../../_common/icons.js';\n\nconst styles = css`\n  :host {\n    display: flex;\n    width: 100%;\n    justify-content: start;\n  }\n\n  .frame-panel-header {\n    display: flex;\n    width: 100%;\n    height: 36px;\n    align-items: center;\n    justify-content: space-between;\n    box-sizing: border-box;\n    padding: 0 8px;\n  }\n\n  .all-frames-setting {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    width: 100px;\n    height: 24px;\n    margin: 8px 4px;\n  }\n\n  .all-frames-setting-button svg {\n    color: var(--affine-icon-secondary);\n  }\n\n  .all-frames-setting-button:hover svg,\n  .all-frames-setting-button.active svg {\n    color: var(--affine-icon-color);\n  }\n\n  .all-frames-setting-label {\n    width: 68px;\n    height: 22px;\n    font-size: var(--affine-font-sm);\n    font-weight: 500;\n    line-height: 22px;\n    color: var(--light-text-color-text-secondary-color, #8e8d91);\n  }\n\n  .frames-setting-container {\n    display: none;\n    justify-content: center;\n    align-items: center;\n    background: var(--affine-background-overlay-panel-color);\n    box-shadow: var(--affine-shadow-2);\n    border-radius: 8px;\n  }\n\n  .frames-setting-container[data-show] {\n    display: flex;\n  }\n\n  .presentation-button {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n    box-sizing: border-box;\n    width: 117px;\n    height: 28px;\n    padding: 4px 8px;\n    border-radius: 8px;\n    margin: 4px 0;\n    border: 1px solid var(--affine-border-color);\n    background: var(--affine-white);\n  }\n\n  .presentation-button:hover {\n    background: var(--affine-hover-color);\n    cursor: pointer;\n  }\n\n  .presentation-button svg {\n    fill: var(--affine-icon-color);\n    margin-right: 4px;\n  }\n\n  .presentation-button-label {\n    font-size: 12px;\n    font-weight: 500;\n    line-height: 20px;\n  }\n`;\n\nexport const AFFINE_FRAME_PANEL_HEADER = 'affine-frame-panel-header';\n\nexport class FramePanelHeader extends WithDisposable(LitElement) {\n  static override styles = styles;\n\n  private _clearEdgelessDisposables = () => {\n    this._edgelessDisposables?.dispose();\n    this._edgelessDisposables = null;\n  };\n\n  private _edgelessDisposables: DisposableGroup | null = null;\n\n  private _enterPresentationMode = () => {\n    if (!this._edgelessRootService) {\n      this.editorHost.std.get(DocModeProvider).setEditorMode('edgeless');\n    }\n\n    setTimeout(() => {\n      this._edgelessRootService?.gfx.tool.setTool({\n        type: 'frameNavigator',\n        mode: this._navigatorMode,\n      });\n    }, 100);\n  };\n\n  private _framesSettingMenuPopper: ReturnType<\n    typeof createButtonPopper\n  > | null = null;\n\n  private _navigatorMode: NavigatorMode = 'fit';\n\n  private _setEdgelessDisposables = () => {\n    if (!this._edgelessRootService) return;\n\n    this._clearEdgelessDisposables();\n    this._edgelessDisposables = new DisposableGroup();\n    this._edgelessDisposables.add(\n      this._edgelessRootService.slots.navigatorSettingUpdated.on(\n        ({ fillScreen }) => {\n          this._navigatorMode = fillScreen ? 'fill' : 'fit';\n        }\n      )\n    );\n  };\n\n  private get _edgelessRootService() {\n    return this.editorHost.std.getOptional(EdgelessRootService);\n  }\n\n  private _tryLoadNavigatorStateLocalRecord() {\n    this._navigatorMode = this.editorHost.std\n      .get(EditPropsStore)\n      .getStorage('presentFillScreen')\n      ? 'fill'\n      : 'fit';\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this._tryLoadNavigatorStateLocalRecord();\n  }\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    if (this._edgelessDisposables) {\n      this._clearEdgelessDisposables();\n    }\n  }\n\n  override firstUpdated() {\n    const disposables = this.disposables;\n\n    this._framesSettingMenuPopper = createButtonPopper(\n      this._frameSettingButton,\n      this._frameSettingMenu,\n      ({ display }) => {\n        this._settingPopperShow = display === 'show';\n      },\n      {\n        mainAxis: 14,\n        crossAxis: -100,\n      }\n    );\n    disposables.add(this._framesSettingMenuPopper);\n  }\n\n  override render() {\n    return html`<div class=\"frame-panel-header\">\n      <div class=\"all-frames-setting\">\n        <span class=\"all-frames-setting-label\">All frames</span>\n        <edgeless-tool-icon-button\n          class=\"all-frames-setting-button ${this._settingPopperShow\n            ? 'active'\n            : ''}\"\n          .tooltip=${this._settingPopperShow ? '' : 'All Frames Settings'}\n          .tipPosition=${'top'}\n          .active=${this._settingPopperShow}\n          .activeMode=${'background'}\n          @click=${() => this._framesSettingMenuPopper?.toggle()}\n        >\n          ${SettingsIcon}\n        </edgeless-tool-icon-button>\n      </div>\n      <div class=\"frames-setting-container\">\n        <affine-frames-setting-menu\n          .editorHost=${this.editorHost}\n        ></affine-frames-setting-menu>\n      </div>\n      <div class=\"presentation-button\" @click=${this._enterPresentationMode}>\n        ${SmallFrameNavigatorIcon}<span class=\"presentation-button-label\"\n          >Presentation</span\n        >\n      </div>\n    </div>`;\n  }\n\n  override updated(_changedProperties: PropertyValues) {\n    if (_changedProperties.has('editorHost')) {\n      if (this._edgelessRootService) {\n        this._setEdgelessDisposables();\n      } else {\n        this._clearEdgelessDisposables();\n      }\n    }\n  }\n\n  @query('.all-frames-setting-button')\n  private accessor _frameSettingButton!: HTMLDivElement;\n\n  @query('.frames-setting-container')\n  private accessor _frameSettingMenu!: HTMLDivElement;\n\n  @state()\n  private accessor _settingPopperShow = false;\n\n  @property({ attribute: false })\n  accessor editorHost!: EditorHost;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [AFFINE_FRAME_PANEL_HEADER]: FramePanelHeader;\n  }\n}\n"]}