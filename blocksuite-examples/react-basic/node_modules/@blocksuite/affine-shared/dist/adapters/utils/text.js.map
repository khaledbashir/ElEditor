{"version":3,"file":"text.js","sourceRoot":"","sources":["../../../src/adapters/utils/text.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,OAAO,EAAE,MAAM,0BAA0B,CAAC;AAEnD,MAAM,WAAW,GAAG,CAClB,GAAkB,EAClB,GAAgB,EAChB,UAA+B,EAAE,KAAK,EAAE,KAAK,EAAE,EAC/C,EAAE;IACF,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;QACrB,OAAO,CAAC,GAAG,CAAC,CAAC;IACf,CAAC;IACD,MAAM,IAAI,GAAG,GAAG,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IACjC,IAAI,OAAO,EAAE,KAAK,EAAE,CAAC;QACnB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC;QACvC,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QACtC,OAAO,GAAG,CAAC;IACb,CAAC;SAAM,IACL,OAAO,IAAI,CAAC,MAAM,KAAK,QAAQ;QAC/B,OAAO,GAAG,CAAC,MAAM,KAAK,QAAQ;QAC9B,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE,GAAG,CAAC,UAAU,CAAC;YACvC,CAAC,IAAI,CAAC,UAAU,KAAK,SAAS,IAAI,GAAG,CAAC,UAAU,KAAK,SAAS,CAAC,CAAC,EAClE,CAAC;QACD,IAAI,CAAC,MAAM,IAAI,GAAG,CAAC,MAAM,CAAC;QAC1B,OAAO,GAAG,CAAC;IACb,CAAC;IACD,OAAO,CAAC,GAAG,GAAG,EAAE,GAAG,CAAC,CAAC;AACvB,CAAC,CAAC;AAEF,MAAM,SAAS,GAAG,CAAC,KAAc,EAAE,EAAE,CAAC,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,SAAS,CAAC;AAE5E,MAAM,UAAU,GAAG,CAAC,CAAS,EAAE,EAAE;IAC/B,OAAO;QACL,4BAA4B,EAAE,IAAI;QAClC,KAAK,EAAE,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC;KAC7C,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,MAAM,GAAG,CAAC,CAAU,EAAE,EAAE;IAC5B,IACE,OAAO,CAAC,KAAK,QAAQ;QACrB,CAAC,KAAK,IAAI;QACV,4BAA4B,IAAI,CAAC,EACjC,CAAC;QACD,OAAO,CAAC,CAAC,4BAA4B,CAAC,KAAK,IAAI,CAAC;IAClD,CAAC;IACD,OAAO,KAAK,CAAC;AACf,CAAC,CAAC;AAEF,SAAS,iBAAiB,CACxB,MAAmD;IAEnD,IAAI,CAAC,MAAM;QAAE,OAAO;IAEpB,MAAM,KAAK,GAAG,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC;SACjC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;SACjC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE;QACjB,IAAI,OAAO,CAAC,KAAK,QAAQ,EAAE,CAAC;YAC1B,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;QACtB,CAAC;QACD,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC;YACrB,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;QACtB,CAAC;QACD,OAAO,KAAK,CAAC;IACf,CAAC,CAAC;SACD,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAGnE,CAAC;IAEJ,OAAO,IAAI,eAAe,CACxB,KAAK;SACF,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC;SAC5B,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAC5D,CAAC;AACJ,CAAC;AAED,MAAM,CAAC,MAAM,SAAS,GAAG;IACvB,WAAW;IACX,SAAS;IACT,UAAU;IACV,MAAM;IACN,iBAAiB;CAClB,CAAC","sourcesContent":["import type { DeltaInsert } from '@blocksuite/inline';\n\nimport { isEqual } from '@blocksuite/global/utils';\n\nconst mergeDeltas = (\n  acc: DeltaInsert[],\n  cur: DeltaInsert,\n  options: { force?: boolean } = { force: false }\n) => {\n  if (acc.length === 0) {\n    return [cur];\n  }\n  const last = acc[acc.length - 1];\n  if (options?.force) {\n    last.insert = last.insert + cur.insert;\n    last.attributes = Object.create(null);\n    return acc;\n  } else if (\n    typeof last.insert === 'string' &&\n    typeof cur.insert === 'string' &&\n    (isEqual(last.attributes, cur.attributes) ||\n      (last.attributes === undefined && cur.attributes === undefined))\n  ) {\n    last.insert += cur.insert;\n    return acc;\n  }\n  return [...acc, cur];\n};\n\nconst isNullish = (value: unknown) => value === null || value === undefined;\n\nconst createText = (s: string) => {\n  return {\n    '$blocksuite:internal:text$': true,\n    delta: s.length === 0 ? [] : [{ insert: s }],\n  };\n};\n\nconst isText = (o: unknown) => {\n  if (\n    typeof o === 'object' &&\n    o !== null &&\n    '$blocksuite:internal:text$' in o\n  ) {\n    return o['$blocksuite:internal:text$'] === true;\n  }\n  return false;\n};\n\nfunction toURLSearchParams(\n  params?: Partial<Record<string, string | string[]>>\n) {\n  if (!params) return;\n\n  const items = Object.entries(params)\n    .filter(([_, v]) => !isNullish(v))\n    .filter(([_, v]) => {\n      if (typeof v === 'string') {\n        return v.length > 0;\n      }\n      if (Array.isArray(v)) {\n        return v.length > 0;\n      }\n      return false;\n    })\n    .map(([k, v]) => [k, Array.isArray(v) ? v.filter(v => v.length) : v]) as [\n    string,\n    string | string[],\n  ][];\n\n  return new URLSearchParams(\n    items\n      .filter(([_, v]) => v.length)\n      .map(([k, v]) => [k, Array.isArray(v) ? v.join(',') : v])\n  );\n}\n\nexport const TextUtils = {\n  mergeDeltas,\n  isNullish,\n  createText,\n  isText,\n  toURLSearchParams,\n};\n"]}