{"version":3,"file":"insert-link-by-quick-search.js","sourceRoot":"","sources":["../../../src/embed-linked-doc-block/commands/insert-link-by-quick-search.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,mBAAmB,EAAE,MAAM,oCAAoC,CAAC;AAMzE,MAAM,CAAC,MAAM,8BAA8B,GAGvC,CAAC,GAAG,EAAE,IAAI,EAAE,EAAE;IAChB,MAAM,EAAE,GAAG,EAAE,GAAG,GAAG,CAAC;IACpB,MAAM,kBAAkB,GAAG,GAAG,CAAC,WAAW,CAAC,mBAAmB,CAAC,CAAC;IAChE,IAAI,CAAC,kBAAkB,EAAE,CAAC;QACxB,IAAI,EAAE,CAAC;QACP,OAAO;IACT,CAAC;IAED,MAAM,gBAAgB,GAA8B,kBAAkB;SACnE,eAAe,EAAE;SACjB,IAAI,CAAC,MAAM,CAAC,EAAE;QACb,IAAI,CAAC,MAAM;YAAE,OAAO,IAAI,CAAC;QAEzB,iBAAiB;QACjB,IAAI,OAAO,IAAI,MAAM,EAAE,CAAC;YACtB,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,sBAAsB,EAAE;gBACvC,KAAK,EAAE,MAAM,CAAC,KAAK;gBACnB,MAAM,EAAE,MAAM,CAAC,MAAM;aACtB,CAAC,CAAC;YACH,OAAO;gBACL,OAAO,EAAE,yBAAyB;aACnC,CAAC;QACJ,CAAC;QAED,mBAAmB;QACnB,IAAI,aAAa,IAAI,MAAM,EAAE,CAAC;YAC5B,+CAA+C;YAC/C,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,gBAAgB,EAAE,EAAE,GAAG,EAAE,MAAM,CAAC,WAAW,EAAE,CAAC,CAAC;YAChE,OAAO;gBACL,OAAO,EAAE,iBAAiB;aAC3B,CAAC;QACJ,CAAC;QAED,OAAO,IAAI,CAAC;IACd,CAAC,CAAC,CAAC;IAEL,IAAI,CAAC,EAAE,gBAAgB,EAAE,CAAC,CAAC;AAC7B,CAAC,CAAC","sourcesContent":["import type { Command } from '@blocksuite/block-std';\n\nimport { QuickSearchProvider } from '@blocksuite/affine-shared/services';\n\nexport type InsertedLinkType = {\n  flavour?: 'affine:bookmark' | 'affine:embed-linked-doc';\n} | null;\n\nexport const insertLinkByQuickSearchCommand: Command<\n  never,\n  'insertedLinkType'\n> = (ctx, next) => {\n  const { std } = ctx;\n  const quickSearchService = std.getOptional(QuickSearchProvider);\n  if (!quickSearchService) {\n    next();\n    return;\n  }\n\n  const insertedLinkType: Promise<InsertedLinkType> = quickSearchService\n    .openQuickSearch()\n    .then(result => {\n      if (!result) return null;\n\n      // add linked doc\n      if ('docId' in result) {\n        std.command.exec('insertEmbedLinkedDoc', {\n          docId: result.docId,\n          params: result.params,\n        });\n        return {\n          flavour: 'affine:embed-linked-doc',\n        };\n      }\n\n      // add normal link;\n      if ('externalUrl' in result) {\n        // @ts-ignore TODO: fix after bookmark refactor\n        std.command.exec('insertBookmark', { url: result.externalUrl });\n        return {\n          flavour: 'affine:bookmark',\n        };\n      }\n\n      return null;\n    });\n\n  next({ insertedLinkType });\n};\n"]}