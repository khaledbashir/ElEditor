{"version":3,"file":"fullscreen-toolbar.js","sourceRoot":"","sources":["../../../src/embed-html-block/components/fullscreen-toolbar.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  menu,\n  popMenu,\n  popupTargetFromElement,\n} from '@blocksuite/affine-components/context-menu';\nimport { EditPropsStore } from '@blocksuite/affine-shared/services';\nimport {\n  CopyIcon,\n  DoneIcon,\n  ExpandCloseIcon,\n  SettingsIcon,\n} from '@blocksuite/icons/lit';\nimport { autoPlacement, flip, offset } from '@floating-ui/dom';\nimport { css, html, LitElement } from 'lit';\nimport { property, query, state } from 'lit/decorators.js';\n\nimport type { EmbedEdgelessHtmlBlockComponent } from '../embed-edgeless-html-block.js';\n\nexport class EmbedHtmlFullscreenToolbar extends LitElement {\n  static override styles = css`\n    :host {\n      box-sizing: border-box;\n      position: absolute;\n      z-index: 1;\n      left: 50%;\n      transform: translateX(-50%);\n      bottom: 0;\n      -webkit-user-select: none;\n      user-select: none;\n    }\n\n    .toolbar-toggle-control {\n      padding-bottom: 20px;\n    }\n\n    .toolbar-toggle-control[data-auto-hide='true'] {\n      transition: 0.27s ease;\n      padding-top: 100px;\n      transform: translateY(100px);\n    }\n\n    .toolbar-toggle-control[data-auto-hide='true']:hover {\n      padding-top: 0;\n      transform: translateY(0);\n    }\n\n    .fullscreen-toolbar-container {\n      background: var(--affine-background-overlay-panel-color);\n      box-shadow: var(--affine-menu-shadow);\n      border: 1px solid var(--affine-border-color);\n      border-radius: 40px;\n\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      gap: 12px;\n\n      padding: 0 20px;\n\n      height: 64px;\n    }\n\n    .short-v-divider {\n      display: inline-block;\n      background-color: var(--affine-border-color);\n      width: 1px;\n      height: 36px;\n    }\n  `;\n\n  private _popSettings = () => {\n    this._popperVisible = true;\n    popMenu(popupTargetFromElement(this._fullScreenToolbarContainer), {\n      options: {\n        items: [\n          () =>\n            html` <div class=\"settings-header\">\n              <span>Settings</span>\n            </div>`,\n          menu.group({\n            name: 'thing',\n            items: [\n              menu.toggleSwitch({\n                name: 'Hide toolbar',\n                on: this.autoHideToolbar,\n                onChange: on => {\n                  this.autoHideToolbar = on;\n                },\n              }),\n            ],\n          }),\n        ],\n        onClose: () => {\n          this._popperVisible = false;\n        },\n      },\n      middleware: [\n        autoPlacement({ allowedPlacements: ['top-end'] }),\n        flip(),\n        offset({ mainAxis: 4, crossAxis: -40 }),\n      ],\n      container: this.embedHtml.iframeWrapper,\n    });\n  };\n\n  copyCode = () => {\n    if (this._copied) return;\n\n    this.embedHtml.std.clipboard\n      .writeToClipboard(items => {\n        items['text/plain'] = this.embedHtml.model.html ?? '';\n        return items;\n      })\n      .then(() => {\n        this._copied = true;\n        setTimeout(() => (this._copied = false), 1500);\n      })\n      .catch(console.error);\n  };\n\n  private get autoHideToolbar() {\n    return (\n      this.embedHtml.std\n        .get(EditPropsStore)\n        .getStorage('autoHideEmbedHTMLFullScreenToolbar') ?? false\n    );\n  }\n\n  private set autoHideToolbar(val: boolean) {\n    this.embedHtml.std\n      .get(EditPropsStore)\n      .setStorage('autoHideEmbedHTMLFullScreenToolbar', val);\n  }\n\n  override render() {\n    const hideToolbar = !this._popperVisible && this.autoHideToolbar;\n\n    return html`\n      <div data-auto-hide=\"${hideToolbar}\" class=\"toolbar-toggle-control\">\n        <div class=\"fullscreen-toolbar-container\">\n          <icon-button @click=\"${this.embedHtml.close}\"\n            >${ExpandCloseIcon()}\n          </icon-button>\n          <icon-button\n            @click=\"${this._popSettings}\"\n            hover=\"${this._popperVisible}\"\n            >${SettingsIcon()}\n          </icon-button>\n\n          <div class=\"short-v-divider\"></div>\n\n          <icon-button class=\"copy-button\" @click=\"${this.copyCode}\"\n            >${this._copied ? DoneIcon() : CopyIcon()}\n          </icon-button>\n        </div>\n      </div>\n    `;\n  }\n\n  @state()\n  private accessor _copied = false;\n\n  @query('.fullscreen-toolbar-container')\n  private accessor _fullScreenToolbarContainer!: HTMLElement;\n\n  @state()\n  private accessor _popperVisible = false;\n\n  @property({ attribute: false })\n  accessor embedHtml!: EmbedEdgelessHtmlBlockComponent;\n}\n"]}