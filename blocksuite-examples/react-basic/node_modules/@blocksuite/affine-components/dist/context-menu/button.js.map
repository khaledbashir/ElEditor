{"version":3,"file":"button.js","sourceRoot":"","sources":["../../src/context-menu/button.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,OAAO,EAAE,SAAS,EAAE,MAAM,wBAAwB,CAAC;AACnD,OAAO,EACL,sBAAsB,EACtB,cAAc,EACd,QAAQ,GACT,MAAM,uBAAuB,CAAC;AAC/B,OAAO,EAAE,QAAQ,EAAE,MAAM,wBAAwB,CAAC;AAClD,OAAO,EAAE,GAAG,EAAE,IAAI,EAAuB,SAAS,EAAE,MAAM,KAAK,CAAC;AAChE,OAAO,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAC7C,OAAO,EAAE,QAAQ,EAAE,MAAM,6BAA6B,CAAC;AACvD,OAAO,EAAE,KAAK,EAAE,MAAM,yBAAyB,CAAC;AAKhD,OAAO,EAAE,aAAa,EAAE,MAAM,gBAAgB,CAAC;IASlC,UAAU;sBAAS,aAAa;;;;iBAAhC,UAAW,SAAQ,WAAa;;;gCA6E1C,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;YAC/B,iKAAS,IAAI,6BAAJ,IAAI,mFAAkB;;;iBA7Ef,WAAM,GAAG,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;2BA0BH,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,YAAY,CAAC,aAAa,CAAC;;;;;;;;;;;GAW5E,CAAC;QAEO,iBAAiB;YACxB,KAAK,CAAC,iBAAiB,EAAE,CAAC;YAC1B,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,YAAY,EAAE,GAAG,EAAE;gBACrD,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,CAAC;gBAC1B,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC;YAC3B,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,YAAY,EAAE,GAAG,EAAE;gBACrD,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC;YAC7B,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QAC7D,CAAC;QAEQ,oBAAoB;YAC3B,KAAK,CAAC,oBAAoB,EAAE,CAAC;YAC7B,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC;QAC7B,CAAC;QAED,OAAO;YACL,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,KAAK,EAAE,CAAC;gBACrC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC;gBACjC,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;YACpB,CAAC;QACH,CAAC;QAEQ,YAAY;YACnB,IAAI,CAAC,OAAO,EAAE,CAAC;QACjB,CAAC;QAEkB,MAAM;YACvB,MAAM,WAAW,GAAG,QAAQ,CAAC;gBAC3B,oBAAoB,EAAE,IAAI;gBAC1B,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK;gBAC9B,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK;aACnB,CAAC,CAAC;YACH,OAAO,IAAI,CAAA,gBAAgB,WAAW,KAAK,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC;QACzE,CAAC;QAGD,6EAA+B;QAA/B,IAAS,IAAI,0CAAkB;QAA/B,IAAS,IAAI,gDAAkB;;;;;;;SA9EpB,UAAU;IAiFV,gBAAgB;sBAAS,aAAa;;;;iBAAtC,gBAAiB,SAAQ,WAAa;;;gCAuDhD,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;YAC/B,iKAAS,IAAI,6BAAJ,IAAI,mFAAkB;;;iBAvDf,WAAM,GAAG,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;GA2B3B,CAAC;QAEO,iBAAiB;YACxB,KAAK,CAAC,iBAAiB,EAAE,CAAC;YAC1B,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QAC7D,CAAC;QAED,OAAO;YACL,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,KAAK,EAAE,CAAC;gBACrC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC;gBACjC,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;YACpB,CAAC;QACH,CAAC;QAEQ,YAAY;YACnB,IAAI,CAAC,OAAO,EAAE,CAAC;QACjB,CAAC;QAEkB,MAAM;YACvB,MAAM,WAAW,GAAG,QAAQ,CAAC;gBAC3B,oBAAoB,EAAE,IAAI;gBAC1B,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK;gBAC9B,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK;aACnB,CAAC,CAAC;YACH,OAAO,IAAI,CAAA,gBAAgB,WAAW,KAAK,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC;QACzE,CAAC;QAGD,6EAA+B;QAA/B,IAAS,IAAI,0CAAkB;QAA/B,IAAS,IAAI,gDAAkB;;;;;;;SAxDpB,gBAAgB;AA2D7B,MAAM,YAAY,GAAG,CAAC,IAAoB,EAAE,IAAU,EAAE,EAAE;IACxD,IAAI,SAAS,EAAE,CAAC;QACd,OAAO,IAAI,CAAA;eACA,IAAI;eACJ,IAAI;2BACQ,CAAC;IAC1B,CAAC;IACD,OAAO,IAAI,CAAA;aACA,IAAI;aACJ,IAAI;yBACQ,CAAC;AAC1B,CAAC,CAAC;AACF,MAAM,CAAC,MAAM,eAAe,GAAG;IAC7B,MAAM,EACJ,CAAC,MAUA,EAAE,EAAE,CACL,IAAI,CAAC,EAAE;QACL,IAAI,MAAM,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC;YACjD,OAAO;QACT,CAAC;QACD,MAAM,IAAI,GAAmB;YAC3B,OAAO,EAAE,GAAG,EAAE;gBACZ,OAAO,IAAI,CAAA;cACP,MAAM,CAAC,MAAM;;gBAEX,MAAM,CAAC,KAAK,EAAE,EAAE,IAAI,MAAM,CAAC,IAAI;;cAEjC,MAAM,CAAC,OAAO,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC;WACjE,CAAC;YACJ,CAAC;YACD,OAAO,EAAE,MAAM,CAAC,OAAO;YACvB,MAAM,EAAE,MAAM,CAAC,MAAM;YACrB,KAAK,EAAE;gBACL,eAAe,EAAE,MAAM,CAAC,UAAU,IAAI,KAAK;gBAC3C,GAAG,MAAM,CAAC,KAAK;aAChB;SACF,CAAC;QACF,OAAO,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IAClC,CAAC;IACH,QAAQ,EACN,CAAC,MAOA,EAAE,EAAE,CACL,IAAI,CAAC,EAAE;QACL,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC;YAC9B,OAAO;QACT,CAAC;QACD,MAAM,IAAI,GAAmB;YAC3B,OAAO,EAAE,GAAG,EAAE,CAAC,IAAI,CAAA;YACf,MAAM,CAAC,OAAO,CAAC,KAAK;gBACpB,CAAC,CAAC,sBAAsB,CAAC,EAAE,KAAK,EAAE,eAAe,EAAE,CAAC;gBACpD,CAAC,CAAC,cAAc,EAAE;;cAEhB,MAAM,CAAC,KAAK,EAAE,EAAE,IAAI,MAAM,CAAC,IAAI;;YAEjC,MAAM,CAAC,OAAO;SACjB;YACD,MAAM,EAAE,GAAG,EAAE;gBACX,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;gBACpC,OAAO,KAAK,CAAC;YACf,CAAC;YACD,KAAK,EAAE,MAAM,CAAC,KAAK,IAAI,EAAE;SAC1B,CAAC;QACF,OAAO,IAAI,CAAA,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,EAAE,CAAC;IAC/D,CAAC;IACH,YAAY,EACV,CAAC,MAOA,EAAE,EAAE,CACL,IAAI,CAAC,EAAE;QACL,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC;YAC9B,OAAO;QACT,CAAC;QACD,MAAM,QAAQ,GAAG,CAAC,EAAW,EAAE,EAAE;YAC/B,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;QACtB,CAAC,CAAC;QAEF,MAAM,IAAI,GAAmB;YAC3B,OAAO,EAAE,GAAG,EAAE,CAAC,IAAI,CAAA;;cAEb,MAAM,CAAC,KAAK,EAAE,EAAE,IAAI,MAAM,CAAC,IAAI;;;mBAG1B,MAAM,CAAC,EAAE;yBACH,QAAQ;;YAErB,MAAM,CAAC,OAAO;SACjB;YACD,MAAM,EAAE,GAAG,EAAE;gBACX,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBAC3B,OAAO,KAAK,CAAC;YACf,CAAC;YACD,KAAK,EAAE,MAAM,CAAC,KAAK,IAAI,EAAE;SAC1B,CAAC;QACF,OAAO,IAAI,CAAA,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,EAAE,CAAC;IAC/D,CAAC;CAC4C,CAAC","sourcesContent":["import type { ReadonlySignal } from '@preact/signals-core';\nimport type { ClassInfo } from 'lit-html/directives/class-map.js';\n\nimport { IS_MOBILE } from '@blocksuite/global/env';\nimport {\n  CheckBoxCkeckSolidIcon,\n  CheckBoxUnIcon,\n  DoneIcon,\n} from '@blocksuite/icons/lit';\nimport { cssVarV2 } from '@toeverything/theme/v2';\nimport { css, html, type TemplateResult, unsafeCSS } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { keyed } from 'lit/directives/keyed.js';\n\nimport type { Menu } from './menu.js';\nimport type { MenuClass, MenuItemRender } from './types.js';\n\nimport { MenuFocusable } from './focusable.js';\n\nexport type MenuButtonData = {\n  content: () => TemplateResult;\n  class: ClassInfo;\n  select: (ele: HTMLElement) => void | false;\n  onHover?: (hover: boolean) => void;\n};\n\nexport class MenuButton extends MenuFocusable {\n  static override styles = css`\n    .affine-menu-button {\n      display: flex;\n      width: 100%;\n      font-size: 20px;\n      cursor: pointer;\n      align-items: center;\n      padding: 4px;\n      gap: 8px;\n      border-radius: 4px;\n      color: var(--affine-icon-color);\n    }\n\n    .affine-menu-button:hover,\n    affine-menu-button.active .affine-menu-button {\n      background-color: var(--affine-hover-color);\n    }\n\n    .affine-menu-button .affine-menu-action-text {\n      flex: 1;\n      font-size: 14px;\n      line-height: 22px;\n      color: var(--affine-text-primary-color);\n    }\n\n    .affine-menu-button.focused {\n      outline: 1px solid ${unsafeCSS(cssVarV2.layer.insideBorder.primaryBorder)};\n    }\n\n    .affine-menu-button.delete-item:hover {\n      background-color: var(--affine-background-error-color);\n      color: var(--affine-error-color);\n    }\n\n    .affine-menu-button.delete-item:hover .affine-menu-action-text {\n      color: var(--affine-error-color);\n    }\n  `;\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this.disposables.addFromEvent(this, 'mouseenter', () => {\n      this.data.onHover?.(true);\n      this.menu.closeSubMenu();\n    });\n    this.disposables.addFromEvent(this, 'mouseleave', () => {\n      this.data.onHover?.(false);\n    });\n    this.disposables.addFromEvent(this, 'click', this.onClick);\n  }\n\n  override disconnectedCallback() {\n    super.disconnectedCallback();\n    this.data.onHover?.(false);\n  }\n\n  onClick() {\n    if (this.data.select(this) !== false) {\n      this.menu.options.onComplete?.();\n      this.menu.close();\n    }\n  }\n\n  override onPressEnter() {\n    this.onClick();\n  }\n\n  protected override render(): unknown {\n    const classString = classMap({\n      'affine-menu-button': true,\n      focused: this.isFocused$.value,\n      ...this.data.class,\n    });\n    return html` <div class=\"${classString}\">${this.data.content()}</div>`;\n  }\n\n  @property({ attribute: false })\n  accessor data!: MenuButtonData;\n}\n\nexport class MobileMenuButton extends MenuFocusable {\n  static override styles = css`\n    .mobile-menu-button {\n      display: flex;\n      width: 100%;\n      cursor: pointer;\n      align-items: center;\n      font-size: 20px;\n      padding: 11px 8px;\n      gap: 8px;\n      border-radius: 4px;\n      color: var(--affine-icon-color);\n    }\n\n    .mobile-menu-button .affine-menu-action-text {\n      flex: 1;\n      color: var(--affine-text-primary-color);\n      font-size: 17px;\n      line-height: 22px;\n    }\n\n    .mobile-menu-button.delete-item {\n      color: var(--affine-error-color);\n    }\n\n    .mobile-menu-button.delete-item .mobile-menu-action-text {\n      color: var(--affine-error-color);\n    }\n  `;\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this.disposables.addFromEvent(this, 'click', this.onClick);\n  }\n\n  onClick() {\n    if (this.data.select(this) !== false) {\n      this.menu.options.onComplete?.();\n      this.menu.close();\n    }\n  }\n\n  override onPressEnter() {\n    this.onClick();\n  }\n\n  protected override render(): unknown {\n    const classString = classMap({\n      'mobile-menu-button': true,\n      focused: this.isFocused$.value,\n      ...this.data.class,\n    });\n    return html` <div class=\"${classString}\">${this.data.content()}</div>`;\n  }\n\n  @property({ attribute: false })\n  accessor data!: MenuButtonData;\n}\n\nconst renderButton = (data: MenuButtonData, menu: Menu) => {\n  if (IS_MOBILE) {\n    return html`<mobile-menu-button\n      .data=\"${data}\"\n      .menu=\"${menu}\"\n    ></mobile-menu-button>`;\n  }\n  return html`<affine-menu-button\n    .data=\"${data}\"\n    .menu=\"${menu}\"\n  ></affine-menu-button>`;\n};\nexport const menuButtonItems = {\n  action:\n    (config: {\n      name: string;\n      label?: () => TemplateResult;\n      prefix?: TemplateResult;\n      postfix?: TemplateResult;\n      isSelected?: boolean;\n      select: (ele: HTMLElement) => void | false;\n      onHover?: (hover: boolean) => void;\n      class?: MenuClass;\n      hide?: () => boolean;\n    }) =>\n    menu => {\n      if (config.hide?.() || !menu.search(config.name)) {\n        return;\n      }\n      const data: MenuButtonData = {\n        content: () => {\n          return html`\n            ${config.prefix}\n            <div class=\"affine-menu-action-text\">\n              ${config.label?.() ?? config.name}\n            </div>\n            ${config.postfix ?? (config.isSelected ? DoneIcon() : undefined)}\n          `;\n        },\n        onHover: config.onHover,\n        select: config.select,\n        class: {\n          'selected-item': config.isSelected ?? false,\n          ...config.class,\n        },\n      };\n      return renderButton(data, menu);\n    },\n  checkbox:\n    (config: {\n      name: string;\n      checked: ReadonlySignal<boolean>;\n      postfix?: TemplateResult;\n      label?: () => TemplateResult;\n      select: (checked: boolean) => boolean;\n      class?: ClassInfo;\n    }) =>\n    menu => {\n      if (!menu.search(config.name)) {\n        return;\n      }\n      const data: MenuButtonData = {\n        content: () => html`\n          ${config.checked.value\n            ? CheckBoxCkeckSolidIcon({ style: `color:#1E96EB` })\n            : CheckBoxUnIcon()}\n          <div class=\"affine-menu-action-text\">\n            ${config.label?.() ?? config.name}\n          </div>\n          ${config.postfix}\n        `,\n        select: () => {\n          config.select(config.checked.value);\n          return false;\n        },\n        class: config.class ?? {},\n      };\n      return html`${keyed(config.name, renderButton(data, menu))}`;\n    },\n  toggleSwitch:\n    (config: {\n      name: string;\n      on: boolean;\n      postfix?: TemplateResult;\n      label?: () => TemplateResult;\n      onChange: (on: boolean) => void;\n      class?: ClassInfo;\n    }) =>\n    menu => {\n      if (!menu.search(config.name)) {\n        return;\n      }\n      const onChange = (on: boolean) => {\n        config.onChange(on);\n      };\n\n      const data: MenuButtonData = {\n        content: () => html`\n          <div class=\"affine-menu-action-text\">\n            ${config.label?.() ?? config.name}\n          </div>\n          <toggle-switch\n            .on=\"${config.on}\"\n            .onChange=\"${onChange}\"\n          ></toggle-switch>\n          ${config.postfix}\n        `,\n        select: () => {\n          config.onChange(config.on);\n          return false;\n        },\n        class: config.class ?? {},\n      };\n      return html`${keyed(config.name, renderButton(data, menu))}`;\n    },\n} satisfies Record<string, MenuItemRender<never>>;\n"]}