{"version":3,"file":"column-renderer.js","sourceRoot":"","sources":["../../../../../src/view-presets/table/pc/header/column-renderer.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,EAAE,iBAAiB,EAAE,MAAM,uBAAuB,CAAC;AAC1D,OAAO,EAAE,aAAa,EAAE,cAAc,EAAE,MAAM,0BAA0B,CAAC;AACzE,OAAO,EAAE,GAAG,EAAE,MAAM,KAAK,CAAC;AAC1B,OAAO,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAC7C,OAAO,EAAE,MAAM,EAAE,MAAM,0BAA0B,CAAC;AAClD,OAAO,EAAE,QAAQ,EAAE,MAAM,6BAA6B,CAAC;AACvD,OAAO,EAAE,IAAI,EAAE,MAAM,oBAAoB,CAAC;IAK7B,qBAAqB;sBAAS,aAAa,CACtD,cAAc,CAAC,iBAAiB,CAAC,CAClC;;;;;;;;;;iBAFY,qBAAsB,SAAQ,WAE1C;;;kCAyDE,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;qCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;iCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;YAL/B,uKAAS,MAAM,6BAAN,MAAM,uFAAe;YAG9B,gLAAS,SAAS,6BAAT,SAAS,6FAAe;YAGjC,oKAAS,KAAK,6BAAL,KAAK,qFAAoC;;;iBA/DlC,WAAM,GAAG,GAAG,CAAA;;;;;;;GAO3B,CAAC;QAEF,IAAI,gBAAgB;YAClB,OAAO,IAAI,CAAC,MAAM,CAAC,IAAuB,CAAC;QAC7C,CAAC;QAEO,WAAW,CAAC,IAAc;YAChC,MAAM,WAAW,GAAG,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;YAC3E,OAAO,IAAI,CAAA;;;;;+BAKgB,IAAI,CAAC,gBAAgB;qBAC/B,IAAI,CAAC,MAAM;;UAEtB,MAAM,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE,KAAK,EAAE,EAAE;gBAC3B,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CACzC,+CAA+C,EAAE,IAAI,CACtD,EAAE,YAAY,CAAC;gBAChB,MAAM,KAAK,GAAG,QAAQ,CAAC;oBACrB,MAAM,EAAE,MAAM,GAAG,IAAI;iBACtB,CAAC,CAAC;gBACH,OAAO,IAAI,CAAA;;;0BAGK,KAAK;;2BAEJ,IAAI,CAAC,MAAM;yBACb,IAAI,CAAC,gBAAgB;0BACpB,EAAE;6BACC,IAAI,CAAC,MAAM,CAAC,EAAE;6BACd,KAAK;gCACF,WAAW;;;iBAG1B,CAAC;YACV,CAAC,CAAC;;;KAGL,CAAC;QACJ,CAAC;QAEQ,MAAM;YACb,OAAO,IAAI,CAAC,WAAW,CACrB,IAAI,CAAC,KAAK,EAAE,IAAI,IAAI,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,KAAK,CACtD,CAAC;QACJ,CAAC;QAGD,iFAA8B;QAA9B,IAAS,MAAM,4CAAe;QAA9B,IAAS,MAAM,kDAAe;QAG9B,6IAAiC;QAAjC,IAAS,SAAS,+CAAe;QAAjC,IAAS,SAAS,qDAAe;QAGjC,+HAAwC,SAAS,GAAC;QAAlD,IAAS,KAAK,2CAAoC;QAAlD,IAAS,KAAK,iDAAoC;;;;;;;SAlEvC,qBAAqB","sourcesContent":["import { ShadowlessElement } from '@blocksuite/block-std';\nimport { SignalWatcher, WithDisposable } from '@blocksuite/global/utils';\nimport { css } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { styleMap } from 'lit/directives/style-map.js';\nimport { html } from 'lit/static-html.js';\n\nimport type { GroupData } from '../../../../core/group-by/trait.js';\nimport type { TableColumn, TableSingleView } from '../../table-view-manager.js';\n\nexport class DataViewColumnPreview extends SignalWatcher(\n  WithDisposable(ShadowlessElement)\n) {\n  static override styles = css`\n    affine-data-view-column-preview {\n      pointer-events: none;\n      display: block;\n      position: fixed;\n      font-family: var(--affine-font-family);\n    }\n  `;\n\n  get tableViewManager(): TableSingleView {\n    return this.column.view as TableSingleView;\n  }\n\n  private renderGroup(rows: string[]) {\n    const columnIndex = this.tableViewManager.propertyIndexGet(this.column.id);\n    return html`\n      <div\n        style=\"background-color: var(--affine-background-primary-color);border-top: 1px solid var(--affine-border-color);box-shadow: var(--affine-shadow-2);\"\n      >\n        <affine-database-header-column\n          .tableViewManager=\"${this.tableViewManager}\"\n          .column=\"${this.column}\"\n        ></affine-database-header-column>\n        ${repeat(rows, (id, index) => {\n          const height = this.container.querySelector(\n            `affine-database-cell-container[data-row-id=\"${id}\"]`\n          )?.clientHeight;\n          const style = styleMap({\n            height: height + 'px',\n          });\n          return html`<div\n            style=\"border-top: 1px solid var(--affine-border-color)\"\n          >\n            <div style=\"${style}\">\n              <affine-database-cell-container\n                .column=\"${this.column}\"\n                .view=\"${this.tableViewManager}\"\n                .rowId=\"${id}\"\n                .columnId=\"${this.column.id}\"\n                .rowIndex=\"${index}\"\n                .columnIndex=\"${columnIndex}\"\n              ></affine-database-cell-container>\n            </div>\n          </div>`;\n        })}\n      </div>\n      <div style=\"height: 45px;\"></div>\n    `;\n  }\n\n  override render() {\n    return this.renderGroup(\n      this.group?.rows ?? this.tableViewManager.rows$.value\n    );\n  }\n\n  @property({ attribute: false })\n  accessor column!: TableColumn;\n\n  @property({ attribute: false })\n  accessor container!: HTMLElement;\n\n  @property({ attribute: false })\n  accessor group: GroupData | undefined = undefined;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'affine-data-view-column-preview': DataViewColumnPreview;\n  }\n}\n"]}