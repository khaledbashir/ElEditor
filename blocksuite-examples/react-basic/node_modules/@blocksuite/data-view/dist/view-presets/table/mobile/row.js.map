{"version":3,"file":"row.js","sourceRoot":"","sources":["../../../../src/view-presets/table/mobile/row.ts"],"names":[],"mappings":"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","sourcesContent":["import { popupTargetFromElement } from '@blocksuite/affine-components/context-menu';\nimport { unsafeCSSVarV2 } from '@blocksuite/affine-shared/theme';\nimport { ShadowlessElement } from '@blocksuite/block-std';\nimport { SignalWatcher, WithDisposable } from '@blocksuite/global/utils';\nimport { CenterPeekIcon, MoreHorizontalIcon } from '@blocksuite/icons/lit';\nimport { css, nothing } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { styleMap } from 'lit/directives/style-map.js';\nimport { html } from 'lit/static-html.js';\n\nimport type { DataViewRenderer } from '../../../core/data-view.js';\nimport type { TableSingleView } from '../table-view-manager.js';\n\nimport { popMobileRowMenu } from './menu.js';\n\nexport class MobileTableRow extends SignalWatcher(\n  WithDisposable(ShadowlessElement)\n) {\n  static override styles = css`\n    .mobile-table-row {\n      width: 100%;\n      display: flex;\n      flex-direction: row;\n      border-bottom: 1px solid var(--affine-border-color);\n      position: relative;\n      min-height: 34px;\n    }\n\n    .mobile-row-ops {\n      position: relative;\n      width: 0;\n      margin-top: 5px;\n      height: max-content;\n      display: flex;\n      gap: 4px;\n      cursor: pointer;\n      justify-content: end;\n      right: 8px;\n    }\n\n    .affine-database-block-row:has([data-editing='true']) .mobile-row-ops {\n      visibility: hidden;\n      opacity: 0;\n    }\n\n    .mobile-row-op {\n      display: flex;\n      padding: 4px;\n      border-radius: 4px;\n      box-shadow: 0px 0px 4px 0px rgba(66, 65, 73, 0.14);\n      background-color: var(--affine-background-primary-color);\n      position: relative;\n      font-size: 16px;\n      color: ${unsafeCSSVarV2('icon/primary')};\n    }\n  `;\n\n  get groupKey() {\n    return this.closest('affine-data-view-table-group')?.group?.key;\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this.classList.add('mobile-table-row');\n  }\n\n  protected override render(): unknown {\n    const view = this.view;\n    return html`\n      ${repeat(\n        view.properties$.value,\n        v => v.id,\n        (column, i) => {\n          const clickDetail = () => {\n            this.dataViewEle.openDetailPanel({\n              view: this.view,\n              rowId: this.rowId,\n            });\n          };\n          const openMenu = (e: MouseEvent) => {\n            const ele = e.currentTarget as HTMLElement;\n            popMobileRowMenu(\n              popupTargetFromElement(ele),\n              this.rowId,\n              this.dataViewEle,\n              this.view\n            );\n          };\n          return html`\n            <div style=\"display: flex;\">\n              <mobile-table-cell\n                class=\"mobile-table-cell\"\n                style=${styleMap({\n                  width: `${column.width$.value}px`,\n                  border: i === 0 ? 'none' : undefined,\n                })}\n                .view=\"${view}\"\n                .column=\"${column}\"\n                .rowId=\"${this.rowId}\"\n                data-row-id=\"${this.rowId}\"\n                .rowIndex=\"${this.rowIndex}\"\n                data-row-index=\"${this.rowIndex}\"\n                .columnId=\"${column.id}\"\n                data-column-id=\"${column.id}\"\n                .columnIndex=\"${i}\"\n                data-column-index=\"${i}\"\n              >\n              </mobile-table-cell>\n              <div class=\"cell-divider\"></div>\n            </div>\n            ${!column.readonly$.value &&\n            column.view.mainProperties$.value.titleColumn === column.id\n              ? html` <div class=\"mobile-row-ops\">\n                  <div class=\"mobile-row-op\" @click=\"${clickDetail}\">\n                    ${CenterPeekIcon()}\n                  </div>\n                  ${!view.readonly$.value\n                    ? html` <div class=\"mobile-row-op\" @click=\"${openMenu}\">\n                        ${MoreHorizontalIcon()}\n                      </div>`\n                    : nothing}\n                </div>`\n              : nothing}\n          `;\n        }\n      )}\n      <div class=\"database-cell add-column-button\"></div>\n    `;\n  }\n\n  @property({ attribute: false })\n  accessor dataViewEle!: DataViewRenderer;\n\n  @property({ attribute: false })\n  accessor rowId!: string;\n\n  @property({ attribute: false })\n  accessor rowIndex!: number;\n\n  @property({ attribute: false })\n  accessor view!: TableSingleView;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'mobile-table-row': MobileTableRow;\n  }\n}\n"]}