{"version":3,"file":"define.js","sourceRoot":"","sources":["../../../src/property-presets/multi-select/define.ts"],"names":[],"mappings":"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","sourcesContent":["import { nanoid } from '@blocksuite/store';\n\nimport type { SelectPropertyData } from '../select/define.js';\n\nimport { getTagColor } from '../../core/component/tags/colors.js';\nimport { type SelectTag, t } from '../../core/index.js';\nimport { propertyType } from '../../core/property/property-config.js';\n\nexport const multiSelectPropertyType = propertyType('multi-select');\nexport const multiSelectPropertyModelConfig =\n  multiSelectPropertyType.modelConfig<string[], SelectPropertyData>({\n    name: 'Multi-select',\n    type: ({ data }) => t.array.instance(t.tag.instance(data.options)),\n    defaultData: () => ({\n      options: [],\n    }),\n    addGroup: ({ text, oldData }) => {\n      return {\n        options: [\n          ...(oldData.options ?? []),\n          {\n            id: nanoid(),\n            value: text,\n            color: getTagColor(),\n          },\n        ],\n      };\n    },\n    formatValue: ({ value }) => {\n      if (Array.isArray(value)) {\n        return value.filter(v => v != null);\n      }\n      return [];\n    },\n    cellToString: ({ value, data }) =>\n      value?.map(id => data.options.find(v => v.id === id)?.value).join(','),\n    cellFromString: ({ value: oldValue, data }) => {\n      const optionMap = Object.fromEntries(data.options.map(v => [v.value, v]));\n      const optionNames = oldValue\n        .split(',')\n        .map(v => v.trim())\n        .filter(v => v);\n\n      const value: string[] = [];\n      optionNames.forEach(name => {\n        if (!optionMap[name]) {\n          const newOption: SelectTag = {\n            id: nanoid(),\n            value: name,\n            color: getTagColor(),\n          };\n          data.options.push(newOption);\n          value.push(newOption.id);\n        } else {\n          value.push(optionMap[name].id);\n        }\n      });\n\n      return {\n        value,\n        data: data,\n      };\n    },\n    cellToJson: ({ value }) => value ?? null,\n    cellFromJson: ({ value }) =>\n      Array.isArray(value) && value.every(v => typeof v === 'string')\n        ? value\n        : undefined,\n    isEmpty: ({ value }) => value == null || value.length === 0,\n  });\n"]}