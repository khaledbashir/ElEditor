{"version":3,"file":"select-group.js","sourceRoot":"","sources":["../../../../src/core/group-by/renderer/select-group.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  menu,\n  popMenu,\n  popupTargetFromElement,\n} from '@blocksuite/affine-components/context-menu';\nimport { css, html } from 'lit';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { styleMap } from 'lit/directives/style-map.js';\n\nimport type { SelectTag } from '../../logical/index.js';\n\nimport { selectOptionColors } from '../../component/tags/colors.js';\nimport { BaseGroup } from './base.js';\n\nexport class SelectGroupView extends BaseGroup<\n  {\n    options: SelectTag[];\n  },\n  string\n> {\n  static override styles = css`\n    data-view-group-title-select-view {\n      overflow: hidden;\n    }\n\n    .data-view-group-title-select-view {\n      width: 100%;\n      cursor: pointer;\n    }\n\n    .data-view-group-title-select-view.readonly {\n      cursor: inherit;\n    }\n\n    .tag {\n      padding: 0 8px;\n      border-radius: 4px;\n      font-size: var(--data-view-cell-text-size);\n      line-height: var(--data-view-cell-text-line-height);\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n    }\n  `;\n\n  private _click = (e: MouseEvent) => {\n    if (this.readonly) {\n      return;\n    }\n    e.stopPropagation();\n    popMenu(popupTargetFromElement(this), {\n      options: {\n        items: [\n          menu.input({\n            initialValue: this.tag?.value ?? '',\n            onChange: text => {\n              this.updateTag({ value: text });\n            },\n          }),\n          ...selectOptionColors.map(({ color, name }) => {\n            const styles = styleMap({\n              backgroundColor: color,\n              borderRadius: '50%',\n              width: '20px',\n              height: '20px',\n            });\n            return menu.action({\n              name: name,\n              isSelected: this.tag?.color === color,\n              prefix: html` <div style=${styles}></div>`,\n              select: () => {\n                this.updateTag({ color });\n              },\n            });\n          }),\n        ],\n      },\n    });\n  };\n\n  get tag() {\n    return this.data.options.find(v => v.id === this.value);\n  }\n\n  protected override render(): unknown {\n    const tag = this.tag;\n    if (!tag) {\n      return html` <div\n        style=\"font-size: 14px;color: var(--affine-text-primary-color);line-height: 22px;\"\n      >\n        Ungroups\n      </div>`;\n    }\n    const style = styleMap({\n      backgroundColor: tag.color,\n    });\n    const classList = classMap({\n      'data-view-group-title-select-view': true,\n      readonly: this.readonly,\n    });\n    return html` <div @click=\"${this._click}\" class=\"${classList}\">\n      <div class=\"tag\" style=\"${style}\">${tag.value}</div>\n    </div>`;\n  }\n\n  updateTag(tag: Partial<SelectTag>) {\n    this.updateData?.({\n      ...this.data,\n      options: this.data.options.map(v => {\n        if (v.id === this.value) {\n          return {\n            ...v,\n            ...tag,\n          };\n        }\n        return v;\n      }),\n    });\n  }\n}\n"]}