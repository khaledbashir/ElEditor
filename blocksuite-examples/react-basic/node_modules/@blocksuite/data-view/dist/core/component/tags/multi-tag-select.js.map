{"version":3,"file":"multi-tag-select.js","sourceRoot":"","sources":["../../../../src/core/component/tags/multi-tag-select.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  createPopup,\n  menu,\n  popMenu,\n  type PopupTarget,\n  popupTargetFromElement,\n} from '@blocksuite/affine-components/context-menu';\nimport { unsafeCSSVarV2 } from '@blocksuite/affine-shared/theme';\nimport { rangeWrap } from '@blocksuite/affine-shared/utils';\nimport { ShadowlessElement } from '@blocksuite/block-std';\nimport { IS_MOBILE } from '@blocksuite/global/env';\nimport { SignalWatcher, WithDisposable } from '@blocksuite/global/utils';\nimport {\n  CloseIcon,\n  DeleteIcon,\n  MoreHorizontalIcon,\n} from '@blocksuite/icons/lit';\nimport { nanoid } from '@blocksuite/store';\nimport { flip, offset } from '@floating-ui/dom';\nimport { computed, type ReadonlySignal, signal } from '@preact/signals-core';\nimport { cssVarV2 } from '@toeverything/theme/v2';\nimport { nothing } from 'lit';\nimport { property, query, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { styleMap } from 'lit/directives/style-map.js';\nimport { html } from 'lit/static-html.js';\n\nimport type { SelectTag } from '../../logical/index.js';\n\nimport { stopPropagation } from '../../utils/event.js';\nimport { dragHandler } from '../../utils/wc-dnd/dnd-context.js';\nimport { defaultActivators } from '../../utils/wc-dnd/sensors/index.js';\nimport {\n  createSortContext,\n  sortable,\n} from '../../utils/wc-dnd/sort/sort-context.js';\nimport { verticalListSortingStrategy } from '../../utils/wc-dnd/sort/strategies/index.js';\nimport { arrayMove } from '../../utils/wc-dnd/utils/array-move.js';\nimport { getTagColor, selectOptionColors } from './colors.js';\nimport { styles } from './styles.js';\n\ntype RenderOption = {\n  value: string;\n  id: string;\n  color: string;\n  isCreate: boolean;\n  select: () => void;\n};\nexport type TagManagerOptions = {\n  mode?: 'single' | 'multi';\n  value: ReadonlySignal<string[]>;\n  onChange: (value: string[]) => void;\n  options: ReadonlySignal<SelectTag[]>;\n  onOptionsChange: (options: SelectTag[]) => void;\n  onComplete?: () => void;\n};\n\nclass TagManager {\n  changeTag = (option: SelectTag) => {\n    this.ops.onOptionsChange(\n      this.ops.options.value.map(item => {\n        if (item.id === option.id) {\n          return {\n            ...item,\n            ...option,\n          };\n        }\n        return item;\n      })\n    );\n  };\n\n  color = signal(getTagColor());\n\n  createOption = () => {\n    const value = this.text.value.trim();\n    if (value === '') return;\n    const id = nanoid();\n    this.ops.onOptionsChange([\n      {\n        id: id,\n        value: value,\n        color: this.color.value,\n      },\n      ...this.ops.options.value,\n    ]);\n    this.selectTag(id);\n    this.text.value = '';\n    this.color.value = getTagColor();\n    if (this.isSingleMode) {\n      this.ops.onComplete?.();\n    }\n  };\n\n  deleteOption = (id: string) => {\n    this.ops.onOptionsChange(\n      this.ops.options.value.filter(item => item.id !== id)\n    );\n  };\n\n  filteredOptions$ = computed(() => {\n    let matched = false;\n    const options: RenderOption[] = [];\n    for (const option of this.options.value) {\n      if (\n        !this.text.value ||\n        option.value\n          .toLocaleLowerCase()\n          .includes(this.text.value.toLocaleLowerCase())\n      ) {\n        options.push({\n          ...option,\n          isCreate: false,\n          select: () => this.selectTag(option.id),\n        });\n      }\n      if (option.value === this.text.value) {\n        matched = true;\n      }\n    }\n    if (this.text.value && !matched) {\n      options.push({\n        id: 'create',\n        color: this.color.value,\n        value: this.text.value,\n        isCreate: true,\n        select: this.createOption,\n      });\n    }\n    return options;\n  });\n\n  optionsMap$ = computed(() => {\n    return new Map<string, SelectTag>(\n      this.ops.options.value.map(v => [v.id, v])\n    );\n  });\n\n  text = signal('');\n\n  get isSingleMode() {\n    return this.ops.mode === 'single';\n  }\n\n  get options() {\n    return this.ops.options;\n  }\n\n  get value() {\n    return this.ops.value;\n  }\n\n  constructor(private ops: TagManagerOptions) {}\n\n  deleteTag(id: string) {\n    this.ops.onChange(this.value.value.filter(item => item !== id));\n  }\n\n  isSelected(id: string) {\n    return this.value.value.includes(id);\n  }\n\n  selectTag(id: string) {\n    if (this.isSelected(id)) {\n      return;\n    }\n    const newValue = this.isSingleMode ? [id] : [...this.value.value, id];\n    this.ops.onChange(newValue);\n    this.text.value = '';\n    if (this.isSingleMode) {\n      requestAnimationFrame(() => {\n        this.ops.onComplete?.();\n      });\n    }\n  }\n}\n\nexport class MultiTagSelect extends SignalWatcher(\n  WithDisposable(ShadowlessElement)\n) {\n  static override styles = styles;\n\n  private _clickItemOption = (e: MouseEvent, id: string) => {\n    e.stopPropagation();\n    const option = this.options.value.find(v => v.id === id);\n    if (!option) {\n      return;\n    }\n    popMenu(popupTargetFromElement(e.currentTarget as HTMLElement), {\n      options: {\n        items: [\n          menu.input({\n            initialValue: option.value,\n            onChange: text => {\n              this.tagManager.changeTag({\n                ...option,\n                value: text,\n              });\n            },\n          }),\n          menu.action({\n            name: 'Delete',\n            prefix: DeleteIcon(),\n            class: {\n              'delete-item': true,\n            },\n            select: () => {\n              this.tagManager.deleteOption(id);\n            },\n          }),\n          menu.group({\n            name: 'color',\n            items: selectOptionColors.map(item => {\n              const styles = styleMap({\n                backgroundColor: item.color,\n                borderRadius: '50%',\n                width: '20px',\n                height: '20px',\n              });\n              return menu.action({\n                name: item.name,\n                prefix: html` <div style=${styles}></div>`,\n                isSelected: option.color === item.color,\n                select: () => {\n                  this.tagManager.changeTag({\n                    ...option,\n                    color: item.color,\n                  });\n                },\n              });\n            }),\n          }),\n        ],\n      },\n    });\n  };\n\n  private _onInput = (event: KeyboardEvent) => {\n    this.tagManager.text.value = (event.target as HTMLInputElement).value;\n  };\n\n  private _onInputKeydown = (event: KeyboardEvent) => {\n    event.stopPropagation();\n    const inputValue = this.text.value.trim();\n    if (event.key === 'Backspace' && inputValue === '') {\n      this.tagManager.deleteTag(this.value.value[this.value.value.length - 1]);\n    } else if (event.key === 'Enter' && !event.isComposing) {\n      this.selectedTag$.value?.select();\n    } else if (event.key === 'ArrowUp') {\n      event.preventDefault();\n      this.setSelectedOption(this.selectedIndex - 1);\n    } else if (event.key === 'ArrowDown') {\n      event.preventDefault();\n      this.setSelectedOption(this.selectedIndex + 1);\n    } else if (event.key === 'Escape') {\n      this.onComplete();\n    }\n  };\n\n  private tagManager = new TagManager(this);\n\n  private selectedTag$ = computed(() => {\n    return this.tagManager.filteredOptions$.value[this.selectedIndex];\n  });\n\n  sortContext = createSortContext({\n    activators: defaultActivators,\n    container: this,\n    onDragEnd: evt => {\n      const over = evt.over;\n      const activeId = evt.active.id;\n      if (over && over.id !== activeId) {\n        this.onOptionsChange(\n          arrayMove(\n            this.options.value,\n            this.options.value.findIndex(v => v.id === activeId),\n            this.options.value.findIndex(v => v.id === over.id)\n          )\n        );\n        this.requestUpdate();\n        // const properties = this.filteredOptions$.value.map(v=>v.id);\n        // const activeIndex = properties.findIndex(id => id === activeId);\n        // const overIndex = properties.findIndex(id => id === over.id);\n      }\n    },\n    modifiers: [\n      ({ transform }) => {\n        return {\n          ...transform,\n          x: 0,\n        };\n      },\n    ],\n    items: computed(() => {\n      return this.tagManager.filteredOptions$.value.map(v => v.id);\n    }),\n    strategy: verticalListSortingStrategy,\n  });\n\n  private get text() {\n    return this.tagManager.text;\n  }\n\n  private renderInput() {\n    return html`\n      <div class=\"tag-select-input-container\">\n        ${this.value.value.map(id => {\n          const option = this.tagManager.optionsMap$.value.get(id);\n          if (!option) {\n            return;\n          }\n          return this.renderTag(option.value, option.color, () =>\n            this.tagManager.deleteTag(id)\n          );\n        })}\n        <input\n          class=\"tag-select-input\"\n          placeholder=\"Type here...\"\n          .value=\"${this.text.value}\"\n          @input=\"${this._onInput}\"\n          @keydown=\"${this._onInputKeydown}\"\n          @pointerdown=\"${stopPropagation}\"\n        />\n      </div>\n    `;\n  }\n\n  private renderTag(name: string, color: string, onDelete?: () => void) {\n    const style = styleMap({\n      backgroundColor: color,\n    });\n    return html` <div class=\"tag-container\" style=${style}>\n      <div class=\"tag-text\">${name}</div>\n      ${onDelete\n        ? html` <div class=\"tag-delete-icon\" @click=\"${onDelete}\">\n            ${CloseIcon()}\n          </div>`\n        : nothing}\n    </div>`;\n  }\n\n  private renderTags() {\n    return html`\n      <div\n        style=\"height: 0.5px;background-color: ${cssVarV2(\n          'layer/insideBorder/border'\n        )};margin: 4px 0;\"\n      ></div>\n      <div class=\"select-options-tips\">Select tag or create one</div>\n      <div class=\"select-options-container\">\n        ${repeat(\n          this.tagManager.filteredOptions$.value,\n          select => select.id,\n          (select, index) => {\n            const isSelected = index === this.selectedIndex;\n            const mouseenter = () => {\n              this.setSelectedOption(index);\n            };\n            const classes = classMap({\n              'select-option': true,\n              selected: isSelected,\n            });\n            const clickOption = (e: MouseEvent) => {\n              e.stopPropagation();\n              this._clickItemOption(e, select.id);\n            };\n            return html`\n              <div\n                ${!select.isCreate ? sortable(select.id) : nothing}\n                class=\"${classes}\"\n                @mouseenter=\"${mouseenter}\"\n                @click=\"${select.select}\"\n              >\n                <div class=\"select-option-content\">\n                  ${select.isCreate\n                    ? html` <div class=\"select-option-new-icon\">Create</div>`\n                    : html`\n                        <div\n                          ${dragHandler(select.id)}\n                          class=\"select-option-drag-handler\"\n                        ></div>\n                      `}\n                  ${this.renderTag(select.value, select.color)}\n                </div>\n                ${!select.isCreate\n                  ? html` <div\n                      class=\"select-option-icon\"\n                      @click=\"${clickOption}\"\n                    >\n                      ${MoreHorizontalIcon()}\n                    </div>`\n                  : null}\n              </div>\n            `;\n          }\n        )}\n      </div>\n    `;\n  }\n\n  private setSelectedOption(index: number) {\n    this.selectedIndex = rangeWrap(\n      index,\n      0,\n      this.tagManager.filteredOptions$.value.length\n    );\n  }\n\n  protected override firstUpdated() {\n    requestAnimationFrame(() => {\n      this._selectInput.focus();\n    });\n    this._disposables.addFromEvent(this, 'click', () => {\n      this._selectInput.focus();\n    });\n\n    this._disposables.addFromEvent(this._selectInput, 'copy', e => {\n      e.stopPropagation();\n    });\n    this._disposables.addFromEvent(this._selectInput, 'cut', e => {\n      e.stopPropagation();\n    });\n  }\n\n  override render() {\n    this.setSelectedOption(this.selectedIndex);\n    return html` ${this.renderInput()} ${this.renderTags()} `;\n  }\n\n  @query('.tag-select-input')\n  private accessor _selectInput!: HTMLInputElement;\n\n  @property()\n  accessor mode: 'multi' | 'single' = 'multi';\n\n  @property({ attribute: false })\n  accessor onChange!: (value: string[]) => void;\n\n  @property({ attribute: false })\n  accessor onComplete!: () => void;\n\n  @property({ attribute: false })\n  accessor onOptionsChange!: (options: SelectTag[]) => void;\n\n  @property({ attribute: false })\n  accessor options!: ReadonlySignal<SelectTag[]>;\n\n  @state()\n  private accessor selectedIndex = 0;\n\n  @property({ attribute: false })\n  accessor value!: ReadonlySignal<string[]>;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'affine-multi-tag-select': MultiTagSelect;\n  }\n}\n\nconst popMobileTagSelect = (target: PopupTarget, ops: TagSelectOptions) => {\n  const tagManager = new TagManager(ops);\n  const onInput = (e: InputEvent) => {\n    tagManager.text.value = (e.target as HTMLInputElement).value;\n  };\n  return popMenu(target, {\n    options: {\n      onClose: () => {\n        ops.onComplete?.();\n      },\n      title: {\n        text: ops.name,\n      },\n      items: [\n        () => {\n          return html`\n            <div\n              style=\"padding: 12px;border-radius: 12px;background-color: ${unsafeCSSVarV2(\n                'layer/background/primary'\n              )};display: flex;gap:8px 12px;\"\n            >\n              ${ops.value.value.map(id => {\n                const option = ops.options.value.find(v => v.id === id);\n                if (!option) {\n                  return;\n                }\n                const style = styleMap({\n                  backgroundColor: option.color,\n                  width: 'max-content',\n                });\n                return html` <div class=\"tag-container\" style=${style}>\n                  <div class=\"tag-text\">${option.value}</div>\n                </div>`;\n              })}\n              <input\n                .value=\"${tagManager.text.value}\"\n                @input=\"${onInput}\"\n                placeholder=\"Type here...\"\n                type=\"text\"\n                style=\"outline: none;border: none;flex:1;min-width: 10px\"\n              />\n            </div>\n          `;\n        },\n        menu.group({\n          items: [\n            menu.dynamic(() => {\n              const options = tagManager.filteredOptions$.value;\n              return options.map(option =>\n                menu.action({\n                  name: option.value,\n                  label: () => {\n                    const style = styleMap({\n                      backgroundColor: option.color,\n                      width: 'max-content',\n                    });\n                    return html`\n                      <div style=\"display: flex; align-items:center;\">\n                        ${option.isCreate\n                          ? html` <div style=\"margin-right: 8px;\">Create</div>`\n                          : ''}\n                        <div class=\"tag-container\" style=${style}>\n                          <div class=\"tag-text\">${option.value}</div>\n                        </div>\n                      </div>\n                    `;\n                  },\n                  select: () => {\n                    option.select();\n                    return false;\n                  },\n                })\n              );\n            }),\n          ],\n        }),\n      ],\n    },\n  });\n};\n\nexport type TagSelectOptions = {\n  name: string;\n  minWidth?: number;\n  container?: HTMLElement;\n} & TagManagerOptions;\nexport const popTagSelect = (target: PopupTarget, ops: TagSelectOptions) => {\n  if (IS_MOBILE) {\n    const handler = popMobileTagSelect(target, ops);\n    return () => {\n      handler.close();\n    };\n  }\n  const component = new MultiTagSelect();\n  if (ops.mode) {\n    component.mode = ops.mode;\n  }\n  const width = target.targetRect.getBoundingClientRect().width;\n  component.style.width = `${Math.max(ops.minWidth ?? width, width)}px`;\n  component.value = ops.value;\n  component.onChange = ops.onChange;\n  component.options = ops.options;\n  component.onOptionsChange = ops.onOptionsChange;\n  component.onComplete = () => {\n    ops.onComplete?.();\n    remove();\n  };\n  const remove = createPopup(target, component, {\n    onClose: ops.onComplete,\n    middleware: [flip(), offset({ mainAxis: -28, crossAxis: 112 })],\n    container: ops.container,\n  });\n  return remove;\n};\n"]}