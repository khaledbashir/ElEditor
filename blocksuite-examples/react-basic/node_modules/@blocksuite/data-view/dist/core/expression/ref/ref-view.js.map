{"version":3,"file":"ref-view.js","sourceRoot":"","sources":["../../../../src/core/expression/ref/ref-view.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,EACL,IAAI,EACJ,uBAAuB,EACvB,sBAAsB,GACvB,MAAM,4CAA4C,CAAC;AACpD,OAAO,EAAE,iBAAiB,EAAE,MAAM,uBAAuB,CAAC;AAC1D,OAAO,EAAE,cAAc,EAAE,MAAM,0BAA0B,CAAC;AAC1D,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,KAAK,CAAC;AAChC,OAAO,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAI7C,OAAO,EAAE,YAAY,EAAE,MAAM,4CAA4C,CAAC;IAE7D,eAAe;sBAAS,cAAc,CAAC,iBAAiB,CAAC;;;;;;;;;;iBAAzD,eAAgB,SAAQ,WAAiC;;;gCAkEnE,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;mCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;gCAG9B,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;YAL/B,iKAAS,IAAI,6BAAJ,IAAI,mFAAsC;YAGnD,0KAAS,OAAO,6BAAP,OAAO,yFAAiC;YAGjD,iKAAS,IAAI,6BAAJ,IAAI,mFAAc;;;iBAxEX,WAAM,GAAG,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;GAsB3B,CAAC;QAEF,IAAI,KAAK;YACP,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;gBACf,OAAO;YACT,CAAC;YACD,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;QACxB,CAAC;QAED,IAAI,SAAS;YACX,MAAM,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC;YACtB,IAAI,CAAC,EAAE,EAAE,CAAC;gBACR,OAAO;YACT,CAAC;YACD,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;QAC1C,CAAC;QAEQ,iBAAiB;YACxB,KAAK,CAAC,iBAAiB,EAAE,CAAC;YAC1B,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC,EAAE;gBAC/C,uBAAuB,CACrB,sBAAsB,CAAC,CAAC,CAAC,MAAqB,CAAC,EAC/C,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAChB,IAAI,CAAC,MAAM,CAAC;oBACV,IAAI,EAAE,CAAC,CAAC,IAAI;oBACZ,MAAM,EAAE,YAAY,CAAC,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC;oBAChC,MAAM,EAAE,GAAG,EAAE;wBACX,IAAI,CAAC,OAAO,CAAC;4BACX,IAAI,EAAE,KAAK;4BACX,IAAI,EAAE,CAAC,CAAC,EAAE;yBACX,CAAC,CAAC;oBACL,CAAC;iBACF,CAAC,CACH,CACF,CAAC;YACJ,CAAC,CAAC,CAAC;QACL,CAAC;QAEQ,MAAM;YACb,MAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC;YAC5B,OAAO,IAAI,CAAA,IAAI,YAAY,CAAC,IAAI,EAAE,IAAI,EAAE,EAAE,CAAC,IAAI,IAAI,EAAE,IAAI,GAAG,CAAC;QAC/D,CAAC;QAGD,qEAAyC,SAAS,EAAC;QAAnD,IAAS,IAAI,0CAAsC;QAAnD,IAAS,IAAI,gDAAsC;QAGnD,uIAAiD;QAAjD,IAAS,OAAO,6CAAiC;QAAjD,IAAS,OAAO,mDAAiC;QAGjD,oIAA2B;QAA3B,IAAS,IAAI,0CAAc;QAA3B,IAAS,IAAI,gDAAc;;;;;;;SAzEhB,eAAe","sourcesContent":["import {\n  menu,\n  popFilterableSimpleMenu,\n  popupTargetFromElement,\n} from '@blocksuite/affine-components/context-menu';\nimport { ShadowlessElement } from '@blocksuite/block-std';\nimport { WithDisposable } from '@blocksuite/global/utils';\nimport { css, html } from 'lit';\nimport { property } from 'lit/decorators.js';\n\nimport type { Variable, VariableRef } from '../types.js';\n\nimport { renderUniLit } from '../../utils/uni-component/uni-component.js';\n\nexport class VariableRefView extends WithDisposable(ShadowlessElement) {\n  static override styles = css`\n    variable-ref-view {\n      font-size: 12px;\n      line-height: 20px;\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      padding: 0 4px;\n      border-radius: 4px;\n      cursor: pointer;\n    }\n\n    variable-ref-view:hover {\n      background-color: var(--affine-hover-color);\n    }\n\n    variable-ref-view svg {\n      width: 16px;\n      height: 16px;\n      fill: var(--affine-icon-color);\n      color: var(--affine-icon-color);\n    }\n  `;\n\n  get field() {\n    if (!this.data) {\n      return;\n    }\n    return this.data.name;\n  }\n\n  get fieldData() {\n    const id = this.field;\n    if (!id) {\n      return;\n    }\n    return this.vars.find(v => v.id === id);\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this.disposables.addFromEvent(this, 'click', e => {\n      popFilterableSimpleMenu(\n        popupTargetFromElement(e.target as HTMLElement),\n        this.vars.map(v =>\n          menu.action({\n            name: v.name,\n            prefix: renderUniLit(v.icon, {}),\n            select: () => {\n              this.setData({\n                type: 'ref',\n                name: v.id,\n              });\n            },\n          })\n        )\n      );\n    });\n  }\n\n  override render() {\n    const data = this.fieldData;\n    return html` ${renderUniLit(data?.icon, {})} ${data?.name} `;\n  }\n\n  @property({ attribute: false })\n  accessor data: VariableRef | undefined = undefined;\n\n  @property({ attribute: false })\n  accessor setData!: (filter: VariableRef) => void;\n\n  @property({ attribute: false })\n  accessor vars!: Variable[];\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'variable-ref-view': VariableRefView;\n  }\n}\n"]}