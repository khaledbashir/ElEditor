{"version":3,"file":"brush-tool-button.js","sourceRoot":"","sources":["../../../../../../src/root-block/edgeless/components/toolbar/brush/brush-tool-button.ts"],"names":[],"mappings":"AAAA,OAAO,EACL,mBAAmB,EACnB,oBAAoB,GACrB,MAAM,qCAAqC,CAAC;AAC7C,OAAO,EACL,cAAc,EACd,aAAa,GACd,MAAM,oCAAoC,CAAC;AAC5C,OAAO,EAAE,aAAa,EAAE,MAAM,0BAA0B,CAAC;AACzD,OAAO,EAAE,QAAQ,EAAE,MAAM,sBAAsB,CAAC;AAChD,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,UAAU,EAAE,MAAM,KAAK,CAAC;AAC5C,OAAO,EAAE,QAAQ,EAAE,MAAM,6BAA6B,CAAC;AAEvD,OAAO,EAAE,sBAAsB,EAAE,MAAM,gBAAgB,CAAC;AACxD,OAAO,EAAE,wBAAwB,EAAE,MAAM,yBAAyB,CAAC;AAEnE,MAAM,OAAO,uBAAwB,SAAQ,wBAAwB,CACnE,aAAa,CAAC,UAAU,CAAC,CAC1B;IAFD;;QA6BU,YAAO,GAAG,QAAQ,CAAC,GAAG,EAAE;YAC9B,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC;YAChE,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG;iBACrB,GAAG,CAAC,aAAa,CAAC;iBAClB,qBAAqB,CACpB,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,EAClE,SAAS,EACT,KAAK,CACN,CAAC;QACN,CAAC,CAAC,CAAC;QAEM,2BAAsB,GAAG,IAAI,CAAC;QAE9B,SAAI,GAAG,OAAgB,CAAC;IAmCnC,CAAC;aA1EiB,WAAM,GAAG,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;GAwB3B,AAxBqB,CAwBpB;IAiBM,gBAAgB;QACtB,IAAI,IAAI,CAAC,gBAAgB,EAAE;YAAE,OAAO;QACpC,CAAC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAChD,MAAM,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,qBAAqB,EAAE,IAAI,CAAC,CAAC;QAC5D,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE;YAC1B,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,QAAQ,EAAE,CAAC,KAA8B,EAAE,EAAE;gBAC3C,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,eAAe,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;gBACtE,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;YAChC,CAAC;SACF,CAAC,CAAC;IACL,CAAC;IAEQ,MAAM;QACb,MAAM,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC;QACxB,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC;QACjE,MAAM,IAAI,GACR,QAAQ,KAAK,MAAM,CAAC,CAAC,CAAC,mBAAmB,CAAC,CAAC,CAAC,oBAAoB,CAAC;QACnE,MAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC;QAEjC,OAAO,IAAI,CAAA;;;mBAGI,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,sBAAsB,CAAC,KAAK,EAAE,GAAG,CAAC;yBAC/C,CAAC;kBACR,MAAM;qBACH,IAAI;iBACR,GAAG,EAAE,CAAC,IAAI,CAAC,gBAAgB,EAAE;;qBAEzB,QAAQ,CAAC,EAAE,KAAK,EAAE,CAAC,wBAAwB,IAAI;;KAE/D,CAAC;IACJ,CAAC","sourcesContent":["import {\n  EdgelessPenDarkIcon,\n  EdgelessPenLightIcon,\n} from '@blocksuite/affine-components/icons';\nimport {\n  EditPropsStore,\n  ThemeProvider,\n} from '@blocksuite/affine-shared/services';\nimport { SignalWatcher } from '@blocksuite/global/utils';\nimport { computed } from '@preact/signals-core';\nimport { css, html, LitElement } from 'lit';\nimport { styleMap } from 'lit/directives/style-map.js';\n\nimport { getTooltipWithShortcut } from '../../utils.js';\nimport { EdgelessToolbarToolMixin } from '../mixins/tool.mixin.js';\n\nexport class EdgelessBrushToolButton extends EdgelessToolbarToolMixin(\n  SignalWatcher(LitElement)\n) {\n  static override styles = css`\n    :host {\n      display: flex;\n      height: 100%;\n      overflow-y: hidden;\n    }\n    .edgeless-brush-button {\n      height: 100%;\n    }\n    .pen-wrapper {\n      width: 35px;\n      height: 64px;\n      display: flex;\n      align-items: flex-end;\n      justify-content: center;\n    }\n    #edgeless-pen-icon {\n      transition: transform 0.3s ease-in-out;\n      transform: translateY(8px);\n    }\n    .edgeless-brush-button:hover #edgeless-pen-icon,\n    .pen-wrapper.active #edgeless-pen-icon {\n      transform: translateY(0);\n    }\n  `;\n\n  private _color$ = computed(() => {\n    const theme = this.edgeless.std.get(ThemeProvider).theme$.value;\n    return this.edgeless.std\n      .get(ThemeProvider)\n      .generateColorProperty(\n        this.edgeless.std.get(EditPropsStore).lastProps$.value.brush.color,\n        undefined,\n        theme\n      );\n  });\n\n  override enableActiveBackground = true;\n\n  override type = 'brush' as const;\n\n  private _toggleBrushMenu() {\n    if (this.tryDisposePopper()) return;\n    !this.active && this.setEdgelessTool(this.type);\n    const menu = this.createPopper('edgeless-brush-menu', this);\n    Object.assign(menu.element, {\n      edgeless: this.edgeless,\n      onChange: (props: Record<string, unknown>) => {\n        this.edgeless.std.get(EditPropsStore).recordLastProps('brush', props);\n        this.setEdgelessTool('brush');\n      },\n    });\n  }\n\n  override render() {\n    const { active } = this;\n    const appTheme = this.edgeless.std.get(ThemeProvider).app$.value;\n    const icon =\n      appTheme === 'dark' ? EdgelessPenDarkIcon : EdgelessPenLightIcon;\n    const color = this._color$.value;\n\n    return html`\n      <edgeless-toolbar-button\n        class=\"edgeless-brush-button\"\n        .tooltip=${this.popper ? '' : getTooltipWithShortcut('Pen', 'P')}\n        .tooltipOffset=${4}\n        .active=${active}\n        .withHover=${true}\n        @click=${() => this._toggleBrushMenu()}\n      >\n        <div style=${styleMap({ color })} class=\"pen-wrapper\">${icon}</div>\n      </edgeless-toolbar-button>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'edgeless-brush-tool-button': EdgelessBrushToolButton;\n  }\n}\n"]}