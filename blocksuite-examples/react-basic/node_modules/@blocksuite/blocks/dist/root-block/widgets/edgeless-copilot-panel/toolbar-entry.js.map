{"version":3,"file":"toolbar-entry.js","sourceRoot":"","sources":["../../../../src/root-block/widgets/edgeless-copilot-panel/toolbar-entry.ts"],"names":[],"mappings":"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","sourcesContent":["import type { EditorHost } from '@blocksuite/block-std';\n\nimport { AIStarIcon } from '@blocksuite/affine-components/icons';\nimport { isGfxGroupCompatibleModel } from '@blocksuite/block-std/gfx';\nimport { WithDisposable } from '@blocksuite/global/utils';\nimport { css, html, LitElement } from 'lit';\nimport { property } from 'lit/decorators.js';\n\nimport type { AIItemGroupConfig } from '../../../_common/components/ai-item/types.js';\nimport type { EdgelessRootBlockComponent } from '../../edgeless/edgeless-root-block.js';\nimport type { CopilotTool } from '../../edgeless/gfx-tool/copilot-tool.js';\n\nimport { sortEdgelessElements } from '../../edgeless/utils/clone-utils.js';\n\nexport class EdgelessCopilotToolbarEntry extends WithDisposable(LitElement) {\n  static override styles = css`\n    .copilot-icon-button {\n      line-height: 20px;\n\n      .label.medium {\n        color: var(--affine-brand-color);\n      }\n    }\n  `;\n\n  private _onClick = () => {\n    this.onClick?.();\n    this._showCopilotPanel();\n  };\n\n  private _showCopilotPanel() {\n    const selectedElements = sortEdgelessElements(\n      this.edgeless.service.selection.selectedElements\n    );\n    const toBeSelected = new Set(selectedElements);\n\n    selectedElements.forEach(element => {\n      // its descendants are already selected\n      if (toBeSelected.has(element)) return;\n\n      toBeSelected.add(element);\n\n      if (isGfxGroupCompatibleModel(element)) {\n        element.descendantElements.forEach(descendant => {\n          toBeSelected.add(descendant);\n        });\n      }\n    });\n\n    this.edgeless.gfx.tool.setTool('copilot');\n    (\n      this.edgeless.gfx.tool.currentTool$.peek() as CopilotTool\n    ).updateSelectionWith(Array.from(toBeSelected), 10);\n  }\n\n  override render() {\n    return html`<edgeless-tool-icon-button\n      aria-label=\"Ask AI\"\n      class=\"copilot-icon-button\"\n      @click=${this._onClick}\n    >\n      ${AIStarIcon} <span class=\"label medium\">Ask AI</span>\n    </edgeless-tool-icon-button>`;\n  }\n\n  @property({ attribute: false })\n  accessor edgeless!: EdgelessRootBlockComponent;\n\n  @property({ attribute: false })\n  accessor groups!: AIItemGroupConfig[];\n\n  @property({ attribute: false })\n  accessor host!: EditorHost;\n\n  @property({ attribute: false })\n  accessor onClick: (() => void) | undefined = undefined;\n}\n"]}