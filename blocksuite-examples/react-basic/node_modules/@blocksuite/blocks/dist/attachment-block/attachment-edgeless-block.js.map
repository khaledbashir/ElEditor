{"version":3,"file":"attachment-edgeless-block.js","sourceRoot":"","sources":["../../src/attachment-block/attachment-edgeless-block.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,qBAAqB,EAAE,MAAM,0BAA0B,CAAC;AACjE,OAAO,EACL,iBAAiB,EACjB,gBAAgB,GACjB,MAAM,kCAAkC,CAAC;AAC1C,OAAO,EAAE,mBAAmB,EAAE,MAAM,uBAAuB,CAAC;AAC5D,OAAO,EAAE,QAAQ,EAAE,MAAM,6BAA6B,CAAC;AAIvD,OAAO,EAAE,wBAAwB,EAAE,MAAM,uBAAuB,CAAC;AAEjE,MAAM,OAAO,gCAAiC,SAAQ,mBAAmB,CACvE,wBAAwB,CACzB;IAFD;;QAGqB,eAAU,GAA2B,IAAI,CAAC;QAEpD,mBAAc,GAAG,KAAK,CAAC;IAkDlC,CAAC;IAhDC,IAAI,WAAW;QACb,OAAO,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,aAAa,CAAwB,CAAC;IACnE,CAAC;IAEQ,iBAAiB;QACxB,KAAK,CAAC,iBAAiB,EAAE,CAAC;QAE1B,MAAM,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;QAErC,IAAI,CAAC,YAAY,CAAC,GAAG,CACnB,WAAW,CAAC,KAAK,CAAC,kBAAkB,CAAC,EAAE,CAAC,GAAG,EAAE;YAC3C,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;YACxB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;QAC3B,CAAC,CAAC,CACH,CAAC;QAEF,IAAI,CAAC,YAAY,CAAC,GAAG,CACnB,WAAW,CAAC,KAAK,CAAC,gBAAgB,CAAC,EAAE,CAAC,GAAG,EAAE;YACzC,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;YACzB,IAAI,CAAC,YAAY;gBACf,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC;QAC9D,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAEQ,OAAO,CAAC,CAAa;QAC5B,OAAO;IACT,CAAC;IAEQ,cAAc;QACrB,MAAM,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC;QAC9B,MAAM,SAAS,GAAG,MAAM,CAAC,KAAK,IAAI,qBAAqB,CAAC,CAAC,CAAC,CAAC;QAC3D,MAAM,KAAK,GAAG,gBAAgB,CAAC,SAAS,CAAC,CAAC;QAC1C,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,CAAC,CAAC;QAC5C,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC;QACtC,MAAM,MAAM,GAAG,KAAK,CAAC,CAAC,GAAG,KAAK,CAAC;QAC/B,MAAM,MAAM,GAAG,KAAK,CAAC,CAAC,GAAG,MAAM,CAAC;QAEhC,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC;YAChC,KAAK,EAAE,GAAG,KAAK,IAAI;YACnB,MAAM,EAAE,GAAG,MAAM,IAAI;YACrB,SAAS,EAAE,SAAS,MAAM,KAAK,MAAM,GAAG;YACxC,eAAe,EAAE,KAAK;YACtB,QAAQ,EAAE,QAAQ;SACnB,CAAC,CAAC;QAEH,OAAO,IAAI,CAAC,iBAAiB,EAAE,CAAC;IAClC,CAAC;CACF","sourcesContent":["import type { HoverController } from '@blocksuite/affine-components/hover';\n\nimport { AttachmentBlockStyles } from '@blocksuite/affine-model';\nimport {\n  EMBED_CARD_HEIGHT,\n  EMBED_CARD_WIDTH,\n} from '@blocksuite/affine-shared/consts';\nimport { toGfxBlockComponent } from '@blocksuite/block-std';\nimport { styleMap } from 'lit/directives/style-map.js';\n\nimport type { EdgelessRootService } from '../root-block/index.js';\n\nimport { AttachmentBlockComponent } from './attachment-block.js';\n\nexport class AttachmentEdgelessBlockComponent extends toGfxBlockComponent(\n  AttachmentBlockComponent\n) {\n  protected override _whenHover: HoverController | null = null;\n\n  override blockDraggable = false;\n\n  get rootService() {\n    return this.std.getService('affine:page') as EdgelessRootService;\n  }\n\n  override connectedCallback(): void {\n    super.connectedCallback();\n\n    const rootService = this.rootService;\n\n    this._disposables.add(\n      rootService.slots.elementResizeStart.on(() => {\n        this._isResizing = true;\n        this._showOverlay = true;\n      })\n    );\n\n    this._disposables.add(\n      rootService.slots.elementResizeEnd.on(() => {\n        this._isResizing = false;\n        this._showOverlay =\n          this._isResizing || this._isDragging || !this._isSelected;\n      })\n    );\n  }\n\n  override onClick(_: MouseEvent) {\n    return;\n  }\n\n  override renderGfxBlock() {\n    const { style$ } = this.model;\n    const cardStyle = style$.value ?? AttachmentBlockStyles[1];\n    const width = EMBED_CARD_WIDTH[cardStyle];\n    const height = EMBED_CARD_HEIGHT[cardStyle];\n    const bound = this.model.elementBound;\n    const scaleX = bound.w / width;\n    const scaleY = bound.h / height;\n\n    this.containerStyleMap = styleMap({\n      width: `${width}px`,\n      height: `${height}px`,\n      transform: `scale(${scaleX}, ${scaleY})`,\n      transformOrigin: '0 0',\n      overflow: 'hidden',\n    });\n\n    return this.renderPageContent();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'affine-edgeless-attachment': AttachmentEdgelessBlockComponent;\n  }\n}\n"]}